<!DOCTYPE html>
<html>
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <link rel="alternate icon" type="image/png" href="/img/favicon.png">
    <title>南蓝的技术博客 | </title>
    
<link rel="stylesheet" href="/css/reset.css">

    
<link rel="stylesheet" href="/css/style.css">

    
<link rel="stylesheet" href="/css/markdown.css">

    
<link rel="stylesheet" href="/css/fonts.css">

<meta name="generator" content="Hexo 6.2.0"></head>
    <body>
        <div class="paper">
            <div class="paper-main">
                
                    <div class="post-header">
    <a class="logo" href="/">南蓝的技术博客</a>
    <a class="go-home" href="/">
        <svg width="8" height="14" viewBox="0 0 8 14">
            <path d="M7 1L1 7l6 6" stroke="#000" stroke-width="2" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
    </a>
</div>
                
                <div class="post-main">

    
        <div class="post-main-title">
            Vue的双向绑定和单向数据流
        </div>
        <div class="post-meta">
            2022-06-03
        </div>
    

    <div class="post-md">
        <div style= "border: 1px solid #ddd; box-shadow: 2px 2px 2px #ddd; padding:10px;">五一假期在家补了课，看到双向绑定与单向数据流的概念。瓦特，我之前以为Vue的V-model就是双向数据流，其实不然,下面让我仔细来看看
</div>

<h3 id="双向绑定"><a href="#双向绑定" class="headerlink" title="双向绑定"></a>双向绑定</h3><p>简而言之，双向绑定就是model的更新会触发view的更新，view的更新会触发model的更新，它们的作用是相互的<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/5/3/16a7caae1cc36343~tplv-t2oaga2asx-image.image" alt="双向绑定"></p>
<h3 id="单向数据流"><a href="#单向数据流" class="headerlink" title="单向数据流"></a>单向数据流</h3><p>简而言之，单向数据流就是model的更新会触发view的更新，view的更新不会触发model的更新，它们的作用是单向的<br><img src="https://p1-jj.byteimg.com/tos-cn-i-t2oaga2asx/gold-user-assets/2019/5/3/16a7d4aacf9dccf9~tplv-t2oaga2asx-image.image" alt="单向数据流"></p>
<p>这不是废话吗，谁都知道的</p>
<p>下面就是真正的干货了，板凳坐好</p>
<ul>
<li>Vue是单向数据流，不是双向绑定</li>
<li>Vue的双向绑定不过是语法糖</li>
<li>Object.definePropert是用来做响应式更新的</li>
</ul>

<h3 id="v-model的实现原理"><a href="#v-model的实现原理" class="headerlink" title="v-model的实现原理"></a>v-model的实现原理</h3><ul>
<li>放在组件上</li>
</ul>
<p>父组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;AnalysisSub v-model=&quot;phoneInfo&quot; :zip-code.sync=&quot;zipCode&quot; /&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>子组件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      :value=&quot;phoneInfo.phone&quot;</span><br><span class="line">      type=&quot;number&quot;</span><br><span class="line">      placeholder=&quot;手机号&quot;</span><br><span class="line">      @input=&quot;handlePhoneChange&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;input</span><br><span class="line">      :value=&quot;zipCode&quot;</span><br><span class="line">      type=&quot;number&quot;</span><br><span class="line">      placeholder=&quot;邮编&quot;</span><br><span class="line">      @input=&quot;handleZipCodeChange&quot;</span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &quot;PersonalInfo&quot;,</span><br><span class="line">  model: &#123;</span><br><span class="line">    prop: &quot;phoneInfo&quot;, // 默认 value</span><br><span class="line">    event: &quot;change&quot; // 默认 input</span><br><span class="line">  &#125;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    phoneInfo: Object,</span><br><span class="line">    zipCode: String</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    handlePhoneChange(e) &#123;</span><br><span class="line">      this.$emit(&quot;change&quot;, &#123;</span><br><span class="line">        ...this.phoneInfo,</span><br><span class="line">        phone: e.target.value</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">    handleZipCodeChange(e) &#123;</span><br><span class="line">      this.$emit(&quot;update:zipCode&quot;, e.target.value);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>父组件的写法等同于</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;AnalysisSub :phone-info=&quot;phoneInfo&quot; @change=&quot;val =&gt; (phoneInfo = val)&quot;</span><br><span class="line">   :zip-code=&quot;zipCode&quot;  @update:zipCode=&quot;val =&gt; (zipCode = val)&quot;/&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>放在input元素上</li>
</ul>
<p>其实上文已经体现了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input v-model=“phoneInfo.phone”/&gt;</span><br><span class="line">&lt;input :value=&quot;PhoneInfo.phone&quot; @input=&quot;val =&gt; &#123; PhoneInfo.phone = val &#125;&quot;</span><br></pre></td></tr></table></figure>
<p>以上两句是相等的</p>
<h3 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h3><p><a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/api/#model">model</a> 2.2.0+</p>
<blockquote>
<p>允许一个自定义组件在使用 v-model 时定制 prop 和 event。默认情况下，一个组件上的 v-model 会把 value 用作 prop 且把 input 用作 event，但是一些输入类型比如单选框和复选框按钮可能想使用 value prop 来达到不同的目的。使用 model 选项可以回避这些情况产生的冲突。</p>
</blockquote>
<p><a target="_blank" rel="noopener" href="https://cn.vuejs.org/v2/guide/components-custom-events.html#sync-%E4%BF%AE%E9%A5%B0%E7%AC%A6">.sync修饰符</a> 2.3.0+</p>
<blockquote>
<p>在有些情况下，我们可能需要对一个 prop 进行“双向绑定”。不幸的是，真正的双向绑定会带来维护上的问题，因为子组件可以修改父组件，且在父组件和子组件都没有明显的改动来源。</p>
</blockquote>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>所以说呢， vue还是单向数据流，v-model只不过是语法糖，它是<code>:value=&quot;sth&quot;</code>和<code> @change=&quot;val =&gt; sth = val&quot;</code>的简写形式。我们通常在面试当中被提问，Vue是怎么实现数据响应式更新的，面试官期望听到的回答是通过<code>Object.defineProperty() </code>的<code>get</code>和<code>set</code>方法来实现响应式更新。 </p>
<p>v-model和.sync修饰符分别在组件单个属性、多个属性需要双向绑定下使用，这是二者使用的场景</p>

    </div>

</div>
                

<link rel="stylesheet" href="/css/a11y-dark.min.css">


<script src="/js/highlight.min.js"></script>


<script src="/js/highlightjs-line-numbers.js"></script>


<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>

            </div>
        </div>
    </body>
</html>